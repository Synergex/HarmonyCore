;;*****************************************************************************
;;
;; Title:       SelfHost.dbl
;;
;; Description: A program to self-host Harmony Core unit tests
;;
;;*****************************************************************************
;; WARNING: GENERATED CODE!
;; This file was generated by CodeGen. Avoid editing the file if possible.
;; Any changes you make will be lost of the file is re-generated.
;;*****************************************************************************

import Microsoft.AspNetCore
import Microsoft.AspNetCore.Hosting
import Microsoft.AspNetCore.TestHost
import System.IO
import Services
import Services.Test
import Services.Test.UnitTests

main SelfHost

proc
    ;;Configure the environment
    UnitTestEnvironment.AssemblyInitialize(^null)

    ;Leave this here for debugging 
    ;data testInstance = new aspHubTests()  
    ;testInstance.multiple_methods_test().Wait()
    ;
    data tester = new HandCrafted()  
    ;tester.AdapterTestBasic()
    ;tester.AdapterTestOptionalParameters()
    ;tester.AdapterTestOrFilter()
    ;tester.AdapterTestOrderBy()
    ;tester.GetOrders_Expand_REL_TagCustomer() 
    ;tester.GetOrders_Expand_REL_TagVendor()
    ;tester.GetOrders_Expand_All()
    tester.DifferentPKJoin2()

    ;;Start self-hosting (Kestrel)
    WebHost.CreateDefaultBuilder(new string[0])
    &    .UseStartup<Startup>()
    &    .UseUrls("http://localhost:8085", "https://localhost:8086")
    &    .Build()
    &    .Run()

    ;;Cleanup the environment
    UnitTestEnvironment.AssemblyCleanup()

endmain