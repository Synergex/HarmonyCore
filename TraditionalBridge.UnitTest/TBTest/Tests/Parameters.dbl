import Json
import Synergex.TestFramework
import Harmony.TraditionalBridge
import System.Text.Json
import TraditionalBridge.Test

namespace TraditionalBridge.UnitTest

    {TestClass}
    public class Parameters

        {TestCategory("Parameters")}
        {Ignore("Missing support for HANDLE")}
        {TestMethod}
        public method SimpleParameters, void
            endparams
            record
                dispatchResult, @string
        proc
            dispatchResult = DispatchRunner.RemoveMessageHeader(DispatchRunner.RunDispatch('{"jsonrpc":"2.0","id":9,"method":"SimpleParameters","params":[{"ReturnedValue":true,"DataType":16},{"PassedValue":"a","DataType":32},{"PassedValue":"b","DataType":32},{"PassedValue":"c","DataType":32},{"PassedValue":1,"DataType":32},{"PassedValue":2,"DataType":32},{"PassedValue":3,"DataType":32},{"PassedValue":44,"DataType":32},{"PassedValue":55,"DataType":32},{"PassedValue":66,"DataType":32},{"PassedValue":7.7,"DataType":32},{"PassedValue":8.8,"DataType":32},{"PassedValue":9.9,"DataType":32},{"PassedValue":9,"DataType":32},{"PassedValue":8,"DataType":32},{"PassedValue":7,"DataType":32},{"PassedValue":65,"DataType":32},{"PassedValue":43,"DataType":32},{"PassedValue":21,"DataType":32},{"PassedValue":123,"DataType":32},{"PassedValue":456,"DataType":32},{"PassedValue":789,"DataType":32},{"PassedValue":1011,"DataType":32},{"PassedValue":1213,"DataType":32},{"PassedValue":1415,"DataType":32},{"PassedValue":{},"DataType":32},{"PassedValue":{},"DataType":32},{"PassedValue":{},"DataType":32}]}'))
            DispatchRunner.EnsureSuccess(dispatchResult)
        endmethod
        
        {TestCategory("Parameters")}
        {TestMethod}
        public method ArrayParameters, void
            endparams
            record
                dispatchResult, @string
        proc
            dispatchResult = DispatchRunner.RemoveMessageHeader(DispatchRunner.RunDispatch('{"jsonrpc":"2.0","id":10,"method":"ArrayParameters","params":[{"ReturnedValue":false},{"PassedValue":[""],"DataType":1024},{"PassedValue":[""],"DataType":1024},{"PassedValue":[""],"DataType":1024},{"PassedValue":[{"GRFA":"","Value":""}],"DataType":32},{"PassedValue":[{"GRFA":"","Value":""}],"DataType":32},{"PassedValue":[{"GRFA":"","Value":""}],"DataType":32}]}'))
            DispatchRunner.EnsureSuccess(dispatchResult)
        endmethod
        
        {TestCategory("Parameters")}
        {TestMethod}
        public method ArrayListParameters, void
            endparams
            record
                dispatchResult, @string
        proc
            dispatchResult = DispatchRunner.RemoveMessageHeader(DispatchRunner.RunDispatch('{"jsonrpc":"2.0","id":11,"method":"ArrayListParameters","params":[{"ReturnedValue":false},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024},{"PassedValue":[],"DataType":1024}]}'))
            DispatchRunner.EnsureSuccess(dispatchResult)
        endmethod
    endclass
endnamespace